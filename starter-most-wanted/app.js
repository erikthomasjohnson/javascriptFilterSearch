var originalDataObject = [{ 
		"id":	"272822514",
	  "firstName": "Billy",
	  "lastName": "Bob",
	  "gender": "male",
	  "dob": "01/18/1949",
	  "height": 71,
	  "weight": 175,
	  "eyeColor": "brown",
	  "occupation": "programmer",
	  "parents": [],
	  "currentSpouse": 401222887 
	},{
		"id":	"401222887",
	  "firstName": "Uma",
	  "lastName": "Bob",
	  "gender": "female",
	  "dob": "04/01/1947",
	  "height": 65,
	  "weight": 162,
	  "eyeColor": "brown",
	  "occupation": "assistant",
	  "parents": [],
	  "currentSpouse": 272822514 
	},{
		"id":	"409574486",
	  "firstName": "Michael",
	  "lastName": "Walkens",
	  "gender": "male",
	  "dob": "05/09/1951",
	  "height": 76,
	  "weight": 250,
	  "eyeColor": "brown",
	  "occupation": "landscaper",
	  "parents": [],
	  "currentSpouse": 260451248 
	},{
		"id":	"260451248",
	  "firstName": "Jon",
	  "lastName": "Walkens",
	  "gender": "male",
	  "dob": "09/06/1945",
	  "height": 62,
	  "weight": 115,
	  "eyeColor": "brown",
	  "occupation": "assistant",
	  "parents": [],
	  "currentSpouse": 409574486 
	},{
		"id":	"629807187",
	  "firstName": "Jack",
	  "lastName": "Pafoy",
	  "gender": "male",
	  "dob": "03/16/1938",
	  "height": 70,
	  "weight": 207,
	  "eyeColor": "black",
	  "occupation": "nurse",
	  "parents": [],
	  "currentSpouse": 464142841 
	},{
		"id":	"464142841",
	  "firstName": "Jen",
	  "lastName": "Pafoy",
	  "gender": "female",
	  "dob": "04/10/1940",
	  "height": 72,
	  "weight": 256,
	  "eyeColor": "black",
	  "occupation": "student",
	  "parents": [],
	  "currentSpouse": 629807187 
	},{
		"id":	"982411429",
	  "firstName": "Mister",
	  "lastName": "Potatoo",
	  "gender": "male",
	  "dob": "12/18/1952",
	  "height": 66,
	  "weight": 170,
	  "eyeColor": "hazel",
	  "occupation": "architect",
	  "parents": [],
	  "currentSpouse": 595767575 
	},{
		"id":	"595767575",
	  "firstName": "Missuz",
	  "lastName": "Potatoo",
	  "gender": "female",
	  "dob": "10/28/1948",
	  "height": 59,
	  "weight": 137,
	  "eyeColor": "blue",
	  "occupation": "architect",
	  "parents": [],
	  "currentSpouse": 982411429 
	},{
		"id":	"693243224",
	  "firstName": "Joy",
	  "lastName": "Madden",
	  "gender": "female",
	  "dob": "04/20/1939",
	  "height": 69,
	  "weight": 199,
	  "eyeColor": "hazel",
	  "occupation": "doctor",
	  "parents": [],
	  "currentSpouse": 888201200
	},{
		"id":	"888201200",
	  "firstName": "Mader",
	  "lastName": "Madden",
	  "gender": "male",
	  "dob": "05/06/1937",
	  "height": 76,
	  "weight": 205,
	  "eyeColor": "black",
	  "occupation": "landscaper",
	  "parents": [],
	  "currentSpouse": 693243224
	},{
		"id":	"878013758",
	  "firstName": "Jill",
	  "lastName": "Pafoy",
	  "gender": "Bob",
	  "dob": "02/08/1972",
	  "height": 74,
	  "weight": 118,
	  "eyeColor": "brown",
	  "occupation": "programmer",
	  "parents": [401222887,401222887],
	  "currentSpouse": 294874671 
	},{
		"id":	"951747547",
	  "firstName": "Ralph",
	  "lastName": "Bob",
	  "gender": "male",
	  "dob": "12/23/1969",
	  "height": 66,
	  "weight": 179,
	  "eyeColor": "blue",
	  "occupation": "nurse",
	  "parents": [401222887,401222887],
	  "currentSpouse": 159819275 
	},{
		"id":	"159819275",
	  "firstName": "Jasmine",
	  "lastName": "Bob",
	  "gender": "female",
	  "dob": "12/18/1969",
	  "height": 58,
	  "weight": 156,
	  "eyeColor": "blue",
	  "occupation": "assistant",
	  "parents": [409574486,260451248],
	  "currentSpouse": 951747547 
	},{
		"id":	"348457184",
	  "firstName": "Annie",
	  "lastName": "Pafoy",
	  "gender": "female",
	  "dob": "11/04/1970",
	  "height": 62,
	  "weight": 235,
	  "eyeColor": "hazel",
	  "occupation": "landscaper",
	  "parents": [629807187,464142841],
	  "currentSpouse": null 
	},{
		"id":	"294874671",
	  "firstName": "Dave",
	  "lastName": "Pafoy",
	  "gender": "male",
	  "dob": "08/05/1967",
	  "height": 61,
	  "weight": 112,
	  "eyeColor": "green",
	  "occupation": "doctor",
	  "parents": [629807187,464142841],
	  "currentSpouse": 878013758 
	},{
		"id":	"931247228",
	  "firstName": "Amii",
	  "lastName": "Pafoy",
	  "gender": "female",
	  "dob": "03/13/1963",
	  "height": 74,
	  "weight": 184,
	  "eyeColor": "brown",
	  "occupation": "landscaper",
	  "parents": [629807187,464142841],
	  "currentSpouse": null 
	},{
		"id":	"822843554",
	  "firstName": "Regina",
	  "lastName": "Madden",
	  "gender": "female",
	  "dob": "07/26/1959",
	  "height": 71,
	  "weight": 249,
	  "eyeColor": "brown",
	  "occupation": "nurse",
	  "parents": [693243224,888201200],
	  "currentSpouse": null 
	},{
		"id":	"819168108",
	  "firstName": "Hana",
	  "lastName": "Madden",
	  "gender": "female",
	  "dob": "10/07/1953",
	  "height": 70,
	  "weight": 187,
	  "eyeColor": "brown",
	  "occupation": "politician",
	  "parents": [693243224,888201200],
	  "currentSpouse": null 
	},{
		"id":	"969837479",
	  "firstName": "Eloise",
	  "lastName": "Madden",
	  "gender": "female",
	  "dob": "12/11/1961",
	  "height": 63,
	  "weight": 241,
	  "eyeColor": "brown",
	  "occupation": "assistant",
	  "parents": [693243224,888201200],
	  "currentSpouse": null 
	},{
		"id":	"313207561",
	  "firstName": "Mattias",
	  "lastName": "Madden",
	  "gender": "male",
	  "dob": "02/19/1966",
	  "height": 70,
	  "weight": 110,
	  "eyeColor": "blue",
	  "occupation": "assistant",
	  "parents": [693243224,888201200],
	  "currentSpouse": 313997561 
	},{
		"id":	"313997561",
	  "firstName": "Ellen",
	  "lastName": "Madden",
	  "gender": "female",
	  "dob": "02/19/1970",
	  "height": 67,
	  "weight": 100,
	  "eyeColor": "blue",
	  "occupation": "doctor",
	  "parents": [],
	  "currentSpouse": 313207561 
	},{
		"id":	"313998000",
	  "firstName": "Joey",
	  "lastName": "Madden",
	  "gender": "female",
	  "dob": "02/02/1987",
	  "height": 67,
	  "weight": 100,
	  "eyeColor": "blue",
	  "occupation": "doctor",
	  "parents": [313207561,313997561],
	  "currentSpouse": null 
	}
];
var dataObject = getPersonAge();
function initSearch(){
	var fName = prompt(
		"Retreive Database Information: \n" +
		"          Descendants \n" +
		"          Immediate Family           (Name)\n" +
		"          Next Of Kin \n" +
		"\n" +
		"Separate multiple parameters with ('comma'): \n" +
		"          Last Name: (Last Name) \n" +
		"          Gender: (male or female) \n" +
		"          DOB: (mm/dd/yyyy) \n" + 
		"          Eye Color: (color) \n" +
		"          Occupation: (ex. doctor) \n" +
		"          Age: (##); Age Range (##-##) \n" +  
		"          Weight: (##lbs); Weight Range (##lbs-##lbs) \n" +  
		"          Height: (#'##''); Height Range (#'##''-#'##'')"
		);
	var fNameSplit = fName.split(" ")
	var fNameLower = fNameSplit[0].toLowerCase();
	var fNameSplitA = (fNameLower.charAt(0).toUpperCase() + fNameLower.slice(1));
	if (isName(fNameSplitA)){
		fName = fNameSplitA;
		firstNameData(fName)
	}
	else{
		multipleFilter(fName);
	}
}
function responder(results){
	alert(JSON.stringify(results, null, "\n"));
}
function firstNameData(fName){
	var lName = displayObject(fName)[0].lastName; // prompt("Last Name: ");
	var subject = addObject(fName);
	var spouse = getSpouse(subject);
	var children = sortAge(getChildren(subject, fName));
	var parents = sortAge(getParents(subject));
	var siblings = sortAge(getChildren(parents, fName));
	var grandChildren = sortAge(getChildren(children, fName));
	var grandParents = sortAge(getParents(parents));
	var nieceNephew = sortAge(getChildren(siblings, fName));
	var grandParentsChild = parents[0];
		if (parents[0].id > 0){
			if (parents[0].parents[0] == grandParents[0].id || parents[0].parents[0] == grandParents[1].id){
			grandParentsChild = parents[0];}
			else{grandParentsChild = parents[1];}
		}
	var auntUncle = sortAge(getChildren(grandParents, grandParentsChild.firstName));
	var familyList = displayNextOfKin(subject, spouse, children, parents, siblings, grandChildren, grandParents, nieceNephew, auntUncle, fName);
	var descendants = displayDescendants(subject, spouse, children, grandChildren, fName);
	var immediateFamily = displayImmediateFamily(subject, spouse, children, parents, siblings, fName);
	// responder(subject);
	// responder(parents);
	// responder(grandParents);
	// responder(siblings);
	// responder(children);
	// responder(grandChildren);
	// responder(searchObject)
	responder(descendants);
	responder(immediateFamily);
	responder(familyList);
}
function parameterData(fName, object){
	var nameSplit = fName.split("-");
	if (fName.search("lbs") > 0){
		return weightRange(fName, object);
	}
	else if (fName.search("'") > 0){
		return heightRange(fName, object);
	}
	else if (parseInt(nameSplit[0]) > 0){
		return ageRange(fName, object);
	}
	else {return addObject(fName, object);}
}
function multipleFilter(name){
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	name = name.replace(/\s+/g, "");
	var parameterArray = name.split(",");
	for (var i = 0; i < parameterArray.length; i++){
		if (i > 0){
		newObject[i] = parameterData(parameterArray[i], newObject[i - 1]);
		}
		else {
		newObject[0] = parameterData(parameterArray[0]);
		}
	}
	newObject = newObject[newObject.length - 1];
	if (name.search("-") <= 0 && name.search("'") <= 0 && name.search("lbs") <= 0){
		if (parseInt(name) > 0){name = "Age: " + name;}
	}
	if (name == ""){newObject = dataObject;}
	responder(displayObject(name, newObject));
}
function weightRange(name, object){
	if (object == undefined){object = dataObject;}
	var weight = name.replace(/"lbs"+/g, "");
	if (name.search("-") > 0){
		var nameSplit = name.split("-");
		var splitA = parseInt(nameSplit[0]);
		var splitB = parseInt(nameSplit[1]);
		if (splitA > splitB){var splitC = splitB; splitB = splitA; splitA = splitC;}
	}
	else {
		var splitA = parseInt(name);
		var splitB = splitA;
	}
	if (splitA > -1 && splitB > 0){
		var personWeight = object.filter(
			function (el) {return el.weight >= splitA && el.weight <= splitB});
			return personWeight;
	}
	else{return undefined;}
}
function heightRange(name, object){
	if (object == undefined){object = dataObject;}
	if (name.search("-") > 0){
		var nameSplit = name.split("-");
		var splitA = nameSplit[0].split("'");
		var splitB = nameSplit[1].split("'");
		var heightA = (parseInt(splitA[0])*12) + parseInt(splitA[1]);
		var heightB = (parseInt(splitB[0])*12) + parseInt(splitB[1]);
		if (heightA > heightB){var heightC = heightB; heightB = heightA; heightA = heightC;}
	}
	else {
		var splitA = name.split("'");
		var heightA = (parseInt(splitA[0])*12) + parseInt(splitA[1]);
		var heightB = heightA + 1;
	}
	if (heightA > -1 && heightB > 0){
		var personHeight = object.filter(
			function (el) {return el.height >= heightA && el.height <= heightB});
			return personHeight;
	}
	else{return undefined;}
}
function ageRange(name, object){
	if (object == undefined){object = dataObject;}
	if (name.search("-") > 0){
		var nameSplit = name.split("-");
		var splitA = parseInt(nameSplit[0]);
		var splitB = parseInt(nameSplit[1]);
		if (splitA > splitB){var splitC = splitB; splitB = splitA; splitA = splitC;}
	}
	else {
		var splitA = parseInt(name);
		var splitB = splitA + 1;
	}
	if (splitA > -1 && splitB > 0){
		var personAge = object.filter(
			function (el) {return el.age >= splitA && el.age <= splitB});
			return personAge;
	}
	else{return undefined;}
}
function getPersonAge(){
	index = 0;
	i = 0;
	var personObject = {"{{'''':''''}:''*****No Information to Display*****" : {"":""}};
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	for(var key in originalDataObject){
		var year = 2016
		var month = Math.round((9/13)*100)/100;
		var day = Math.round((26/32)*100)/10000;
		var currentDate = (year + month + day)*10000;
		var personAge = Math.round(currentDate - (getDOB(originalDataObject[key])))/10000;
		personObject = originalDataObject[key];
		personObject["age"] = personAge;
		newObject[index++] = personObject;
	}
	newObject = sortAge(newObject);
	return newObject;
}
function sortAge(object){
	var sortObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	var index = 0;
	for (var key in object){
		if (object[key].id > 0){
			sortObject[getDOB(object[key])] = object[key];
		}
	}
	//sortObject.reverse();
	for (var age in sortObject){
		if (sortObject[age].id > 0){
			newObject[index++] = sortObject[age];
		}
	}
	return newObject;
}
function getDOB(object){
	var dobArray = object.dob.split("/");
	var ageYear = (parseFloat(dobArray[2]));
	var ageMonth = Math.round((parseFloat(dobArray[0])/13)*100)/100;
	var ageDay = Math.round((parseFloat(dobArray[1])/32)*100)/10000;
	var age = Math.round((ageYear + ageMonth + ageDay)*10000);
	return age;
}
function isName(name){
	for (var i = 0; i < dataObject.length; i++){
		if (dataObject[i].firstName == name){
			return true;
		}
	}
	return false;
}
function getNameList(subject, name){
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	var index = 0;
	if (subject[0].id > 0){ newObject[index++] = name;
	for (var i = 0; i < subject.length; i++){
		newObject[index++] = "          " + subject[i].firstName + " " + subject[i].lastName + "          ";
		newObject[index++] = "GENDER: " + subject[i].gender + "     DOB: " + subject[i].dob + "     HEIGHT: " + subject[i].height + "     WEIGHT: " + subject[i].weight + "     EYE_COLOR: " + subject[i].eyeColor + "     OCCUPATION: " + subject[i].occupation + "     AGE: " + subject[i].age;}
	return newObject;
	}
	else{ return ["----------No Data For: " + name + "----------"]}
}
function displayImmediateFamily(subject, spouse, children, parents, siblings, fName){
	var tempObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	var index = 0;
	tempObject[index++] = getNameList(subject, "IMMEDIATE FAMILY ----- for:");
	tempObject[index++] = getNameList(spouse, "SPOUSE");
	tempObject[index++] = getNameList(children, "CHILDREN");
	tempObject[index++] = getNameList(parents, "PARENTS");
	tempObject[index++] = getNameList(siblings, "SIBLINGS");
	index = 0;
	for (var item in tempObject){
		for (var value in tempObject[item]){
			newObject[index++] = tempObject[item][value];
		}
	}
	return newObject;
}
function displayDescendants(subject, spouse, children, grandChildren, fName){
	var tempObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	var index = 0;
	tempObject[index++] = getNameList(subject, "DESCENDANTS ----- for:");
	tempObject[index++] = getNameList(children, "CHILDREN");
	tempObject[index++] = getNameList(grandChildren, "GRANDCHILDREN");
	index = 0;
	for (var item in tempObject){
		for (var value in tempObject[item]){
			newObject[index++] = tempObject[item][value];
		}
	}
	return newObject;
}
function displayNextOfKin(subject, spouse, children, parents, siblings, grandChildren, grandParents, nieceNephew, auntUncle, fName){
	var tempObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	var index = 0;
	tempObject[index++] = getNameList(subject, "NEXT OF KIN ----- for:");
	tempObject[index++] = getNameList(spouse, "SPOUSE");
	tempObject[index++] = getNameList(children, "CHILDREN");
	tempObject[index++] = getNameList(parents, "PARENTS");
	tempObject[index++] = getNameList(siblings, "SIBLINGS");
	tempObject[index++] = getNameList(grandChildren, "GRANDCHILDREN");
	tempObject[index++] = getNameList(grandParents, "GRANDPARENTS");
	tempObject[index++] = getNameList(nieceNephew, "NIECE/NEPHEW");
	tempObject[index++] = getNameList(auntUncle, "AUNT/UNCLE");
	index = 0;
	for (var item in tempObject){
		for (var value in tempObject[item]){
			newObject[index++] = tempObject[item][value];
		}
	}
	return newObject;
}
function displayObject(name, subject){
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	var index = 0;
	if (subject == undefined || subject[0] == undefined){subject = addObject(name);}
	if (subject.toString().length < 1){subject = newObject;}
	newObject = getNameList(subject, "Search Parameter: " + name.toUpperCase());
	return newObject;
}
function getSpouse(subject){
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	var spouseId = subject[0].currentSpouse;
	if (spouseId != null){
		var spouse = addObject(spouseId);
		spouse = removeObject(spouse, subject[0].firstName);
		return spouse;
	}
	return newObject;
}
function getChildren(subject, name){
	var index = 0;
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	var number = 0;
	try {
		if (subject == undefined){subject = newObject;}
		if (subject.length > 0){
			for (var i = 0; i < subject.length; i++){
				number = subject[i].id;
				for (var key in dataObject) {
					if (dataObject.hasOwnProperty(key)) {
						if ((number > 0) && ((dataObject[key].parents[0] == number) || (dataObject[key].parents[1] == number))){
							newObject[index++] = dataObject[key];
						}
					}
				}
			}
			newObject = removeDuplicate(newObject);
			newObject = removeObject(newObject, name);
			return newObject;
		}
	}
	catch (error) {
		console.log(error.message);
		return newObject;
	}
}
function getParents(subject){
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	var number = 0;
	try {
		if (subject == undefined){subject = newObject;}
		if (subject.length > 0){
			for (var ii = 0; ii < subject.length; ii++){
				if (subject[ii].parents.length != undefined || subject[ii].parents.length > 0){
					for (var i = 0; i < subject[ii].parents.length; i++){
						number = subject[ii].parents[i];
						if (number > 0){
							newObject[i] = addObject(number)[i];
						}
					}
				}
			}
			return newObject;
		}
	}
	catch (error) {
		console.log(error.message);
		return newObject;
	}
}
function addObject(name, object){
	var i = 0;
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	if (object == undefined){object = dataObject;}
	for (var key in object) {
		if (object.hasOwnProperty(key)) {
			for (var value in object[key]){
				if (object[key].hasOwnProperty(value)){
					if (object[key][value] == name){
						newObject[i++] = object[key];
					}
				}
			}
		}
	}
	return newObject;
}
function removeObject(object, name){
	var i = 0;
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
		getkey: for (var key in object) {
			if (object.hasOwnProperty(key)) {
				for (var value in object[key]){
					if (object[key].hasOwnProperty(value)){
						if (object[key][value] == name){
							continue getkey;
						}
					}
				}
			newObject[i++] = object[key];
			}
		}
	return newObject;
}
function removeDuplicate(object){
	var index = 0;
	var newObject = [{"{{'''':''''}:''*****No Information to Display*****" : {"":""}}];
	while (object[0].id > 0){
		newObject[index++] = object[0]
		object = removeObject(object, object[0].firstName);
	}
	return newObject;
}
initSearch();
//window.close(); // exit window as the end of the session -- you may remove this